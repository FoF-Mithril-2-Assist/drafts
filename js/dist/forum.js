module.exports=function(t){var o={};function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=t,a.c=o,a.d=function(t,o,e){a.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:e})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,o){if(1&o&&(t=a(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var n in t)a.d(e,n,function(o){return t[o]}.bind(null,n));return e},a.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(o,"a",o),o},a.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},a.p="",a(a.s=18)}([function(t,o){t.exports=flarum.core.compat.Model},function(t,o){t.exports=flarum.core.compat.app},function(t,o){t.exports=flarum.core.compat.extend},function(t,o){t.exports=flarum.core.compat["components/DiscussionComposer"]},function(t,o){t.exports=flarum.core.compat["models/User"]},function(t,o){t.exports=flarum.core.compat["utils/mixin"]},function(t,o){t.exports=flarum.core.compat["components/Page"]},function(t,o){t.exports=flarum.core.compat.Component},function(t,o){t.exports=flarum.core.compat["components/LoadingIndicator"]},function(t,o){t.exports=flarum.core.compat["helpers/avatar"]},function(t,o){t.exports=flarum.core.compat["helpers/icon"]},function(t,o){t.exports=flarum.core.compat["helpers/humanTime"]},function(t,o){t.exports=flarum.core.compat["utils/string"]},function(t,o){t.exports=flarum.core.compat["components/HeaderSecondary"]},function(t,o){t.exports=flarum.core.compat["components/NotificationsDropdown"]},function(t,o){t.exports=flarum.core.compat["components/Button"]},,function(t,o){t.exports=flarum.core.compat["utils/ItemList"]},function(t,o,a){"use strict";a.r(o);var e=a(2),n=a(4),r=a.n(n),i=a(0),s=a.n(i);function c(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o}var p=a(5),f=function(t){function o(){return t.apply(this,arguments)||this}return c(o,t),o}(a.n(p)()(s.a,{user:s.a.hasOne("user"),content:s.a.attribute("content"),title:s.a.attribute("title"),relationships:s.a.attribute("relationships"),updatedAt:s.a.attribute("updatedAt",s.a.transformDate)})),u=a(6),l=a.n(u),d=a(7),h=a.n(d),y=a(8),x=a.n(y),g=a(3),v=a.n(g),b=a(9),N=a.n(b),w=a(10),O=a.n(w),j=a(11),C=a.n(j),_=(a(17),a(12)),P=function(t){function o(){return t.apply(this,arguments)||this}c(o,t);var a=o.prototype;return a.init=function(){this.loading=!1},a.view=function(){var t=this,o=app.cache.drafts||[];return m("div",{className:"NotificationList RequestsList"},m("div",{className:"NotificationList-header"},m("h4",{className:"App-titleControl App-titleControl--text"},app.translator.trans("fof-drafts.forum.dropdown.title"))),m("div",{className:"NotificationList-content"},m("ul",{className:"NotificationGroup-content"},o.length?o.map(function(o){return m("li",null,m("a",{onclick:t.showComposer.bind(t,o),className:"Notification Request"},N()(o.user()),O()("fas fa-edit",{className:"Notification-icon"}),m("span",{className:"Notification-content"},o.title()),C()(o.updatedAt()),m("div",{className:"Notification-excerpt"},Object(_.truncate)(o.content(),200))))}):this.loading?x.a.component({className:"LoadingIndicator--block"}):m("div",{className:"NotificationList-empty"},app.translator.trans("fof-drafts.forum.dropdown.empty_text")))))},a.showComposer=function(t){var o={originalContent:t.content(),title:t.title(),user:app.session.user,draft:t};console.log(t),Object.keys(t.relationships()).forEach(function(a){t.relationships()[a].data.map(function(o,e){t.relationships()[a].data[e]=app.store.getById(o.type,o.id)}),o[a]=t.relationships()[a].data});var a=new v.a(o);app.composer.load(a),app.composer.show()},a.load=function(){var t=this;app.cache.drafts||(this.loading=!0,m.redraw(),app.store.find("drafts").then(function(t){delete t.payload,app.cache.drafts=t.sort(function(t,o){return o.updatedAt()-t.updatedAt()})}).catch(function(){}).then(function(){t.loading=!1,m.redraw()}))},o}(h.a),A=function(t){function o(){return t.apply(this,arguments)||this}c(o,t);var a=o.prototype;return a.init=function(){t.prototype.init.call(this),app.history.push("drafts"),this.list=new P,this.list.load(),this.bodyClass="App--drafts"},a.view=function(){return m("div",{className:"DraftsPage"},this.list.render())},o}(l.a),L=a(1),S=a.n(L),k=a(13),D=a.n(k),M=a(14),B=function(t){function o(){return t.apply(this,arguments)||this}c(o,t),o.initProps=function(o){o.label=o.label||app.translator.trans("fof-drafts.forum.dropdown.tooltip"),o.icon=o.icon||"fas fa-edit",t.initProps.call(this,o)};var a=o.prototype;return a.init=function(){t.prototype.init.call(this),this.list=new P},a.goToRoute=function(){m.route(app.route("drafts"))},a.getUnreadCount=function(){return app.cache.drafts?app.cache.drafts.length:app.session.user.data.relationships.drafts.data.length},a.getNewCount=function(){return app.cache.drafts?app.cache.drafts.length:app.session.user.data.relationships.drafts.data.length},o}(a.n(M).a),I=a(15),R=a.n(I);app.initializers.add("fof-drafts",function(){app.store.models.drafts=f,r.a.prototype.drafts=s.a.hasMany("drafts"),app.routes.drafts={path:"/drafts",component:m(A,null)},Object(e.extend)(v.a.prototype,"headerItems",function(t){var o=this;app.forum.attribute("canSaveDrafts")&&(console.log(this.props),t.add("save-draft",R.a.component({icon:"fas fa-save",className:"Button Button--icon Button--link",style:"margin: 0 10px 2px -10px;",title:app.translator.trans("fof-drafts.forum.composer.title"),onclick:function(){o.draft&&o.draft.save(o.data()).then(function(t){app.cache.drafts||(app.cache.drafts=[]),app.cache.drafts.some(function(o,a){o.id()===t.id()&&(app.cache.drafts[a]=t)}),app.composer.hide()}),console.log(o.data()),app.store.createRecord("drafts").save(o.data()).then(function(t){app.cache.drafts||(app.cache.drafts=[]),app.cache.drafts.push(t),app.composer.hide()})}}),20))}),Object(e.extend)(v.a.prototype,"init",function(){var t=this;console.log(this.props),Object.keys(this.props).forEach(function(o){["originalContent","title","user"].includes(o)?"title"===o&&(t.title=m.prop(t.props.title)):t[o]=t.props[o]})}),Object(e.extend)(D.a.prototype,"items",function(t){(S.a.session.user.data.relationships.drafts&&S.a.session.user.data.relationships.drafts.data.length&&!S.a.cache.drafts||S.a.cache.drafts&&0!==S.a.cache.drafts.length)&&t.add("Drafts",m(B,null),20)})})}]);
//# sourceMappingURL=forum.js.map